# 第2回 非線形物理講義ノート
- 授業日: 2023-10-11 （想定）
- 科目: Statistical mechanics of disordered systems
- 担当: 吉野元

## ガラス現象の基礎的特徴
- 参考文献リスト：Spinglass Theory And Beyond、Binder & Young、Mydosh、Mézard & Montanari、Parisi-Urbani-Zamponi など。
- 対象システム
  - スピングラス（クエンチ無秩序あり、典型例は $p=2$ のランダムイジング模型）
  - 構造ガラス（過冷却液→ガラス転移）
  - 最適化問題・統計的推論・機械学習（無秩序の有無を問わずガラス的挙動）
- 理論的視点
  - 平均場理論（レプリカ法、RFOT、タッピング近似など）
  - 摂動的RGやドロップレット理論による有限次元補正
  - 近年はジャミング、アモルファス固体の first-principles 記述、木構造グラフ上の問題への展開がホットな話題

## 制約充足問題 (CSP) とガラス
- 例：魔方陣や SAT（$K$-SAT）など。$N$ 個の変数が $M$ 個の制約を満たす必要がある。
- 制約数 $M$ を増やすと解集合がクラスタ化し、やがて消失（UNSAT/jamming）する。
- グラフ彩色問題：離散彩色（$q$ 色）と連続彩色（角度条件付き XY スピン）
  - 彩色の解がクラスタ化する様子がガラストランジションと類似。

## 統計的推論への橋渡し
### ベイズ公式の復習
$$
P(A\mid B) = \frac{P(B\mid A) P(A)}{P(B)}
$$
- 事後分布（posterior）は、尤度と事前分布から定まる。
- $P(B)$（evidence）は正規化定数。

### Teacher-Student シナリオ
1. 教師が事前分布 $P(A)$ から真のパラメータ $A$ を生成。
2. 尤度 $P(B\mid A)$ に従ってデータ $B$ を作り、学生へ渡す。
3. 学生はベイズ公式で事後分布 $P(A\mid B)$ を構成し、推定値を得る。

- エネルギー表現：$H(A\mid B) = -\ln P(B\mid A) - \ln P(A)$。
- 平均の種類：
  - データ平均 $\langle \cdots \rangle_{B}$
  - 固定されたデータに対する学生内部の平均 $\langle \cdots \rangle_{\text{student}}$

### 情報量の指標
- 相互情報量：$I(A;B) = \langle \log \frac{P(A,B)}{P(A)P(B)} \rangle$
  - KLダイバージェンス $D_{\mathrm{KL}}(P(A\mid B) \| P(A))$ としても解釈。
- ニシムリ条件（Bayes optimal case）：教師と学生の事前分布／尤度が一致するときに成り立つ恒等式。
- 推定量
  - MMSE 推定器：$\hat{A}_{\text{MMSE}} = \sum_A P(A\mid B) A$
  - MAP 推定器：事後分布を最大化する $A$ を選ぶ。

## モデル設定の導入
### 一般化 $p$-スピン模型（密グラフ）
- 変数ノード $i=1,\dots,N$、ファクターノード $\mu=1,\dots,N_f$ を持つ二部グラフ。
- 各ファクターは $p$ 本、各変数は $c$ 本のエッジを持ち、$N_f p = Nc$ を満たす。
- 平衡分布：
$$
P(S_1,\dots,S_N) = \frac{1}{Z} \prod_{\mu=1}^{N_f} \psi_\mu\bigl(\{ S_i \}_{i\in \partial \mu} \bigr)
  \prod_{i=1}^N \phi_i(S_i)
$$
- ハミルトニアン表現：$H = -\sum_\mu \ln \psi_\mu - \sum_i \ln \phi_i$。
- バイアス項 $\phi_i(S_i)$ は局所磁場 $h_i$ を表す（例：$\ln \phi_i = h_i S_i$）。

### 密で木状なグラフの扱い
- ループ長 $L_{\text{loop}} \sim \ln N / \ln[c(p-1)]$。
- $1 \ll c \ll N$ の「中程度に密な」グラフでは、ループを無視できる平均場解析が可能。
- 層状構造（深層ネットワーク）にも拡張可能：幅 $N$、深さ $L$、層間で $c$ 本の結合を持つ設定。

### 無秩序なし模型の例
- スピン変数の種類：イジングスピン $S_i=\pm1$、球面スピン $\sum_i S_i^2 = N$ など。
- 典型的な $p$-体ハミルトニアン：
$$
H = - J \sum_{\mu} \prod_{i \in \partial \mu} S_i
$$
  - $J$ は結合強度、$p$ 体相互作用を表す。

## 次回予告メモ
- $p$-スピン模型の平均場解析（自由エネルギー展開、プレフカ展開）へ進む。
- 層状グラフと深層学習モデルの関連、ベクトル型スピンへの拡張にも触れる予定。

---
※元資料: `lecture-note.pdf`（非公開扱いにつき取り扱い注意）
